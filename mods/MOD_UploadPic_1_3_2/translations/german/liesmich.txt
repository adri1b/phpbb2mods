	/*******************************************
	*       UploadPic, ein MOD für phpBB       *
	*       ----------------------------       *
	*                                          *
	*   date       : 08/2005 - 02/2006         *
	*   (C)/author : B.Funke                   *
	*   URL        : http://forum.beehave.de   *
	*                                          *
	********************************************/


UploadPic erlaubt Usern eines phpBB-Forums, Bilder auf den Webspace des Forums
hochzuladen, um diese im Forum zu verwenden.
Vielen Benutzern steht kein Webspace zur Verfügung, viele wissen auch nicht,
wie man ein FTP-Programm verwendet, so daß diesen Usern nur die Möglichkeit
bleibt, bereits im Internet vorhandene Bilder (deren dauerhafte Verfügbarkeit
nicht garantiert werden kann) im Forum zu verwenden.
Hier setzt UploadPic ein ...



Die Admin
---------

UploadPic

Dieses Panel erlaubt einen Überblick über alle User, die Bilder hochgeladen
haben. Es werden die Anzahl der Bilder und der verbrauchte Speicherplatz
angezeigt.
Der Link "Alle unbenutzten Bilder löschen" löscht alle Bilddateien, die in
keiner Nachricht des Forums (oder als Avatar oder in einer PN) verwendet
werden, um Speicherplatz zu sparen.
Die Funktion "Alle alten Bilder aus PN löschen" löscht alle Bilder aus
privaten Nachrichten, die Ablaufdauer für Bilder in PN überschritten haben.
In der Konfiguration kann angegeben werden, daß die "letzten x Uploads"
auf dieser Seite angegeben werden (wenn dieser Wert auf 0 gesetzt wird,
werden keine Dateien angezeigt).

UploadPic config

Dieser Link öffnet eine Seite mit Einstellungen zu UploadPic. Sämtliche
Optionen werden in der Datenbank gespeichert.

UploadPic groups

Öffnet eine Auswahlliste mit allen Gruppen. Nach Auswahl einer Gruppe kann
für alle Benutzer dieser Gruppe die Erlaubnis zum Upload gesetzt (oder
entzogen) werden.
Hinweis: Diese Darstellung dient der besseren Kontrolle der Berechtigungen
für Mitglieder einer Gruppe. Die Berechtigungen werden aus Sicherheitsgründen
aber immer nur pro Mitglied, nicht aber pro Gruppe gespeichert, es erfolgt
keine automatische Zuteilung von Berechtigungen durch Gruppenzugehörigkeit.

UploadPic aktuell

Diese Seite zeigt die zuletzt hochgeladenen Bilder. Die Anzahl der hier
anzuzeigenen Bilder kann in der Konfiguration eingestellt werden.
Neben den Bildern werden Informationen über die Gebrauch des Bilder, die
Größe und den User, der das Bild hochgeladen hat, angezeigt - es kann
ausgwählt werden, ob das Bild gelöscht werden soll (wenn es nicht in
Gebrauch ist) oder ob man es "zensieren" möchte.
Diese Funktion kann benutzt werden, um ungewollte oder unpassende Bilder
loszuwerden, ohne die Nachricht editieren oder sich durch die Datenbank
graben zu müssen. Es wird auch kein häßliches "nicht gefunden"-Icon
angezeigt, sondern ein selbst festgelegtes Bild. Das Originalbild wird
von diesem überschrieben.
Die "zensiert"-Bilder können im Bildverzeichnis des jeweiligen Templates,
z.B. templates/subSilver/images/lang_german, geändert werden. Es gibt 3
Bilder, eins für jedes Format: gif/jpg/png. Es sollte darauf geachtet
werden, daß die Bilder nicht größer als die maximal erlaubte Avatar-
Größe sind, wenn man Remote-Avatare erlaubt, da mit UploadPic hochgeladene
Bilder in dem Fall u.U. auch als Avatare genutzt werden können und so
beim Austausch durch zu große "zensiert"-Bilder das Layout zerstören
könnten.
Hinweis: Wenn keine "zensiert"-Bilder erscheinen sollen, können diese
einfach vom Webspace gelöscht werden, in diesem Fall werden hochgeladene
Bilder, die "zensiert" werden sollen, einfach gelöscht.

UploadPic users

Mit diesem Panel kann die Erlaubnis zum Upload für mehrere User gleichzeitig
gesetzt werden, damit bei Foren mit sehr vielen Usern nicht jedes
Benutzerprofil einzeln aufgerufen werden muß.
Ein Klick auf einen Benutzernamen öffnet die Detailansicht des Benutzers,
nicht verwendete Bilder sind mit einem "Löschen"-Link gekennzeichnet, ein
Klick auf den Bildernamen zeigt das jeweilige Bild an.



UploadPic erlaubt das Einfügen eines hochgeladenen Bildes entweder über das
BBCode-[img]-Tag (sichtbar direkt in der Nachricht), bei vorliegender
Installation des left/right-MODs auch mit entsprechender Ausrichtung, oder
über das [url]-Tag (oder beides, einzustellen in der Konfiguration).
Wenn den Usern erlaubt wird Bilder hochzuladen, die das Layout des Forums
sprengen würden, empfiehlt es sich, nur das [url]-Tag zuzulassen. Dabei wird
in der Nachricht ein Textlink eingefügt, der bei Klick ein neues Fenster mit
dem Bild öffnet.
Falls beim Upload Probleme auftreten, sollte versucht werden, die erlaubten
Bild-Abmessungen zu verringern. Manche Provider erlauben nur geringe
Speicherlast für PHP-Skripte, so daß das Erzeugen großer Bilder in einer
Fehlermeldung resultiert.

UploadPic kann benutzt werden, um auch für andere Eingabefelder BBCode
einzufügen. Um das zu bewerkstelligen, muß UploadPic mit der Variable
"inputname" aufgerufen werden, wenn das Textfeld, in das der Code eingefügt
werden soll, anders heißt als "message" (Standard-Textarea in der posting.php
von phpBB). Auf diese Weise kann UploadPic z.B. mit dem MOD "Quick Reply"
verwendet werden.
Der einzufügende Code und weitere Informationen zur Nutzung der Variable
findet sich in den FAQ, Punkt III. 5.:
http://www.beehave.de/forum/viewtopic.php?t=521

UploadPic kann auch für die "Knowledge Base" benutzt werden. Den Code, der
die entsprechenden Knowledge Base-Dateien ändert, ist in den FAQ, Punkt
III. 7. zu finden:
http://www.beehave.de/forum/viewtopic.php?t=521

UploadPic kann auch für "easyCMS" benutzt werden. Den Code, der nötigen
Dateien ändert, ist in den FAQ, Punkt III. 11. zu finden:
http://www.beehave.de/forum/viewtopic.php?t=521

Darüber hinaus kann und werde ich für fremde MODs KEINEN Support leisten
noch für den Einbau des Codes in fremde MODs Verantwortung übernehmen.




Hinweise zur Installation:

Die beigefügten und zu ändernden .tpl-Dateien sind für jedes verwendete
Template zu ändern/hochzuladen. Da in der Standardinstallation "subSilver"
enthalten ist, wurde dieses Template diesem MOD zugrunde gelegt. (Auch wenn
ich subSilver selbst garnicht verwende :)
Da es unmöglich ist, alle möglichen Templates zu kennen, kann ich für
Probleme mit anderen Templates als subSilver keinen Support leisten.

Im Ordern "translations" finden sich die Änderungen für die jeweiligen
Sprachdateien. Soll eine andere Sprache als Englisch verwendet werden, muß
nach dem Ausführen von "uploadpic.txt" (im Hauptverzeichnis des Archivs)
noch die entsprechende Datei aus dem "translations"-Ordner ausgeführt werden.
Die in diesem Ordner vorhandenen Dateien ändern NUR DIE SPRACHDATEIEN,
für die Installation von UploadPic muß die Datei /uploadpic.txt ausgeführt
werden.
Wenn jemand UploadPic in seine Sprache übersetzt hat und seine Arbeit anderen
zugute kommen lassen möchte, kann er/sie mir die Dateien zukommen lassen,
damit sie im nächsten Update mitgeliefert werden können.

Wichtig:
Nach dem Hochladen/Ändern der Dateien muß einmalig die Datei
/install/install_uploadpic.php aufgerufen und im Anschluss daran das install-
Verzeichnis gelöscht werden.

Um die Erlaubnis zum Upload standardmäßig auf "ja" zu setzen, muß die Datei
install_uploadpic.php VOR dem Ausführen geändert werden. Ändere die Zeile:
	$sql[] = 'ALTER TABLE ' . USERS_TABLE . ' ADD user_allow_uploadpic TINYINT NOT NULL DEFAULT 0';
in:
	$sql[] = 'ALTER TABLE ' . USERS_TABLE . ' ADD user_allow_uploadpic TINYINT NOT NULL DEFAULT 1';

oder, wenn du PostgreSQL benutzt, ändere die Zeilen:
	$sql[] = 'ALTER TABLE ' . USERS_TABLE . ' ALTER COLUMN user_allow_uploadpic SET DEFAULT 0';
	$sql[] = 'UPDATE TABLE ' . USERS_TABLE . ' SET user_allow_uploadpic = 0 WHERE user_allow_uploadpic IS NULL';
in:
	$sql[] = 'ALTER TABLE ' . USERS_TABLE . ' ALTER COLUMN user_allow_uploadpic SET DEFAULT 1';
	$sql[] = 'UPDATE TABLE ' . USERS_TABLE . ' SET user_allow_uploadpic = 1 WHERE user_allow_uploadpic IS NULL';

Wenn das userpix-Verzeichnis anders heissen soll, muß "userpix" in der folgende
Zeile geändert werden:
$str_updirname = 'userpix';
(wenn das Verzeichnis woanders abgelegt werden soll, kann ein Pfad eingegeben
werden, z.B. 'images/userpix')



Hinweise zur Sicherheit:

Dieses MOD wird so, wie es ist, zur Verfügung gestellt. Auch wenn sämtliche
Funktionen und Sicherheits-Checks des MODs ausführlich getestet wurden,
übernehme ich keinerlei Verantwortung für jedwede Folgen (erwünscht oder
unerwünscht), die aus der Benutzung und/oder Installation dieses MODs
resultieren, die Verwendung erfolgt auf eigene Gefahr.

Wenn der Server, auf dem das Forum läuft, das Auflisten von Verzeichnissen
im Browser erlaubt, empfehle ich die Verwendung einer index.htm-Datei im
UploadPic-Verzeichnis, damit niemand den Verzeichnisinhalt dadurch
einsehen kann, daß die Verzeichnis-URL im Browser aufgerufen wird.
Zu diesem Zweck kann einfach die "index.htm"-Datei aus dem Verzeichnis
"images" in das UploadPic-Verzeichnis kopiert werden.

UploadPic darf frei kopiert und verwendet werden, solange alle mitgelieferten
Dateien unverändert bleiben. Für alle weiteren (rechtlichen) Hinweise gilt für
dieses MOD die GNU GENERAL PUBLIC LICENSE.


Noch einmal: UploadPic kann dazu benutzt werden, den Webspace des Forums mit
Müll anzufüllen und den Traffic der Site zu steigern. Wenn nicht ausreichend
Speicherplatz zur Verfügung steht, sollte die Erlaubnis zum Upload nur
bekannten und vertrauenswürdigen Usern gestattet werden, um nicht irgenwann
keinen Webspace mehr zu haben, nur weil ein User meint, er müsse seine
komplette Fotosammlung ins Forum hochladen.


Was ich ebenfalls NICHT empfehle, ist die Änderung des Wertes
"uploadpic_delete" auf "false", vor allem in Verbindung mit dem Wert
"uploadpic_uniqfn = true":
uploadpic_delete bestimmt, ob ein hochgeladenes Bild nach dem Upload gelöscht
wird, wenn der User "zurück" oder "Abbruch" anklickt (das Bild also doch
nicht verwenden will), um Speicherplatz zu sparen. Wenn ein Admin natürlich
wissen will, wie oft welcher User welches Bild hochgeladen hat, um es dann
doch nicht zu verwenden, kann er den Wert ruhig auf "false" setzen.
uploadpic_uniqfn legt fest, ob bei jedem Upload überprüft wird, ob ein Bild
mit diesem Namen schon existiert. Es wird an den vom User angegebenen
Bildnamen die Kombination "_NR" angehängt, wobei "NR" eine Zahl ist, die
hochgezählt wird. Dieses Feature soll verhindern, daß ein User zu
verschiedenen Zeiten Bilder hochlädt, die alle denselben Namen haben und sich
so überschreiben würden.


Des weiteren ist es keine gute Idee, die erlaubten Dateitypen zu erweitern.
Ohne die Verwendung eines (nicht implementierten) externen Programms kann PHP
z.B. keine tif- oder bmp-Dateien verwenden. Nicht-Bilddateien sollten
grundsätzlich nicht angegeben werden (abgesehen davon, daß diese Fehler im
Skript hervorrufen würden).



Hinweise zum Support:

Für Vorschläge zu UploadPic, Hinweise auf Fehler / Probleme oder
Dankesbekundungen :) kann mein Forum benutzt werden:
http://www.beehave.de/forum/viewforum.php?f=17

Bevor jedoch Fragen gestellt werden oder generelle Probleme beim  Einbau von
MODs auftreten, empfehle ich die Lektüre der entsprechenden Artikel auf
phpbb.de/phpbb.com.
Anfragen, die in dieser Dokumentation und/oder den FAQ in meinem Forum
(http://www.beehave.de/forum/viewtopic.php?t=521) schon behandelt wurden
oder allgemeine Probleme im Umgang mit PHP/FTP/SQL etc. betreffen, werden
von mir NICHT bearbeitet, sonst käme ich zu nichts anderem mehr ;)

Für eine generelle Hilfe zum Installieren von MODs unter phpBB, s. hier:
http://www.phpbb.de/doku/kb/artikel.php?artikel=18
für eine Anleitung zu phpMyAdmin s. hier:
http://www.phpbb.de/doku/kb/artikel.php?artikel=pma_faq



Viel Spaß, BF
