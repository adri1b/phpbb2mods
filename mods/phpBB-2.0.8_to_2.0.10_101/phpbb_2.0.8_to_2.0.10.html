<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html dir="ltr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="Content-Style-Type" content="text/css">

<title>phpBB 2.0.8 to phpBB 2.0.10 Code Changes</title>

<style type="text/css">
<!--
/* General page style. The scroll bar colours only visible in IE5.5+ */
body {
	background-color: #E5E5E5;
	scrollbar-face-color: #DEE3E7;
	scrollbar-highlight-color: #FFFFFF;
	scrollbar-shadow-color: #DEE3E7;
	scrollbar-3dlight-color: #D1D7DC;
	scrollbar-arrow-color:  #006699;
	scrollbar-track-color: #EFEFEF;
	scrollbar-darkshadow-color: #98AAB1;
}

/* General font families for common tags */
font,th,td,p { font-family: Verdana, Arial, Helvetica, sans-serif }
a:link,a:active,a:visited { color : #006699; }
a:hover		{ text-decoration: underline; color : #DD6900; }
hr	{ height: 0px; border: solid #D1D7DC 0px; border-top-width: 1px;}

/* This is the border line & background colour round the entire page */
.bodyline	{ background-color: #FFFFFF; border: 1px #98AAB1 solid; }

/* This is the outline round the main forum tables */
.forumline	{ background-color: #FFFFFF; border: 2px #006699 solid; }

/* Main table cell colours and backgrounds */
td.row1	{ background-color: #EFEFEF; }
td.row2	{ background-color: #DEE3E7; }
td.row3	{ background-color: #D1D7DC; }

/*
  This is for the table cell above the Topics, Post & Last posts on the index.php page
  By default this is the fading out gradiated silver background.
  However, you could replace this with a bitmap specific for each forum
*/
td.rowpic {
		background-color: #FFFFFF;
		background-image: url(templates/subSilver/images/cellpic2.jpg);
		background-repeat: repeat-y;
}

/* Header cells - the blue and silver gradient backgrounds */
th	{
	color: #FFA34F; font-size: 11px; font-weight : bold;
	background-color: #006699; height: 25px;
	background-image: url(templates/subSilver/images/cellpic3.gif);
}

td.cat,td.catHead,td.catSides,td.catLeft,td.catRight,td.catBottom {
			background-image: url(templates/subSilver/images/cellpic1.gif);
			background-color:#D1D7DC; border: #FFFFFF; border-style: solid; height: 28px;
}

/*
  Setting additional nice inner borders for the main table cells.
  The names indicate which sides the border will be on.
  Don't worry if you don't understand this, just ignore it :-)
*/
td.cat,td.catHead,td.catBottom {
	height: 29px;
	border-width: 0px 0px 0px 0px;
}
th.thHead,th.thSides,th.thTop,th.thLeft,th.thRight,th.thBottom,th.thCornerL,th.thCornerR {
	font-weight: bold; border: #FFFFFF; border-style: solid; height: 28px;
}
td.row3Right,td.spaceRow {
	background-color: #D1D7DC; border: #FFFFFF; border-style: solid;
}

th.thHead,td.catHead { font-size: 12px; border-width: 1px 1px 0px 1px; }
th.thSides,td.catSides,td.spaceRow	 { border-width: 0px 1px 0px 1px; }
th.thRight,td.catRight,td.row3Right	 { border-width: 0px 1px 0px 0px; }
th.thLeft,td.catLeft	  { border-width: 0px 0px 0px 1px; }
th.thBottom,td.catBottom  { border-width: 0px 1px 1px 1px; }
th.thTop	 { border-width: 1px 0px 0px 0px; }
th.thCornerL { border-width: 1px 0px 0px 1px; }
th.thCornerR { border-width: 1px 1px 0px 0px; }

/* The largest text used in the index page title and toptic title etc. */
.maintitle	{
	font-weight: bold; font-size: 22px; font-family: "Trebuchet MS",Verdana, Arial, Helvetica, sans-serif;
	text-decoration: none; line-height : 120%; color : #000000;
}

/* General text */
.gen { font-size : 12px; }
.genmed { font-size : 11px; }
.gensmall { font-size : 10px; }
.gen,.genmed,.gensmall { color : #000000; }
a.gen,a.genmed,a.gensmall { color: #006699; text-decoration: none; }
a.gen:hover,a.genmed:hover,a.gensmall:hover	{ color: #DD6900; text-decoration: underline; }

/* The register, login, search etc links at the top of the page */
.mainmenu		{ font-size : 11px; color : #000000 }
a.mainmenu		{ text-decoration: none; color : #006699;  }
a.mainmenu:hover{ text-decoration: underline; color : #DD6900; }

/* Forum category titles */
.cattitle		{ font-weight: bold; font-size: 12px ; letter-spacing: 1px; color : #006699}
a.cattitle		{ text-decoration: none; color : #006699; }
a.cattitle:hover{ text-decoration: underline; }

/* Forum title: Text and link to the forums used in: index.php */
.forumlink		{ font-weight: bold; font-size: 12px; color : #006699; }
a.forumlink 	{ text-decoration: none; color : #006699; }
a.forumlink:hover{ text-decoration: underline; color : #DD6900; }

/* Used for the navigation text, (Page 1,2,3 etc) and the navigation bar when in a forum */
.nav			{ font-weight: bold; font-size: 11px; color : #000000;}
a.nav			{ text-decoration: none; color : #006699; }
a.nav:hover		{ text-decoration: underline; }

/* titles for the topics: could specify viewed link colour too */
.topictitle,h1,h2	{ font-weight: bold; font-size: 11px; color : #000000; }
a.topictitle:link   { text-decoration: none; color : #006699; }
a.topictitle:visited { text-decoration: none; color : #5493B4; }
a.topictitle:hover	{ text-decoration: underline; color : #DD6900; }

/* Name of poster in viewmsg.php and viewtopic.php and other places */
.name			{ font-size : 11px; color : #000000;}

/* Location, number of posts, post date etc */
.postdetails		{ font-size : 10px; color : #000000; }

/* The content of the posts (body of text) */
.postbody { font-size : 12px; line-height: 18px}
a.postlink:link	{ text-decoration: none; color : #006699 }
a.postlink:visited { text-decoration: none; color : #5493B4; }
a.postlink:hover { text-decoration: underline; color : #DD6900}

/* Quote & Code blocks */
.code {
	font-family: Courier, 'Courier New', sans-serif; font-size: 11px; color: #006600;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

.quote {
	font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 11px; color: #444444; line-height: 125%;
	background-color: #FAFAFA; border: #D1D7DC; border-style: solid;
	border-left-width: 1px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px
}

/* Copyright and bottom info */
.copyright		{ font-size: 10px; font-family: Verdana, Arial, Helvetica, sans-serif; color: #444444; letter-spacing: -1px;}
a.copyright		{ color: #444444; text-decoration: none;}
a.copyright:hover { color: #000000; text-decoration: underline;}

/* Form elements */
input,textarea, select {
	color : #000000;
	font: normal 11px Verdana, Arial, Helvetica, sans-serif;
	border-color : #000000;
}

/* The text input fields background colour */
input.post, textarea.post, select {
	background-color : #FFFFFF;
}

input { text-indent : 2px; }

/* The buttons used for bbCode styling in message post */
input.button {
	background-color : #EFEFEF;
	color : #000000;
	font-size: 11px; font-family: Verdana, Arial, Helvetica, sans-serif;
}

/* The main submit button option */
input.mainoption {
	background-color : #FAFAFA;
	font-weight : bold;
}

/* None-bold submit button */
input.liteoption {
	background-color : #FAFAFA;
	font-weight : normal;
}

/* This is the line in the posting page which shows the rollover
  help line. This is actually a text box, but if set to be the same
  colour as the background no one will know ;)
*/
.helpline { background-color: #DEE3E7; border-style: none; }

-->
</style>
</head>
<body bgcolor="#E5E5E5" text="#000000" link="#006699" vlink="#5493B4">

<table class="forumline" width="100%" cellspacing="1" cellpadding="4" border="0">
	<tr>
		<td class="row1"><table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td>
<span class="postbody"><span style="font-size: 18px; line-height: normal">phpBB 2.0.8 to phpBB 2.0.10 Code Changes</span>
<br /><br /><br />
<br />
These are the Changes from phpBB 2.0.8 to phpBB 2.0.10 summed up into a little Mod. This might be very helpful if you want to update your Board and have installed a bunch of Mods. Then it's normally easier to apply the Code Changes than to install all Mods again.<br />
<br />
When you find a 'AFTER, ADD'-Statement, the Code have to be added after the last line quoted in the 'FIND'-Statement.<br />
When you find a 'BEFORE, ADD'-Statement, the Code have to be added before the first line quoted in the 'FIND'-Statement.<br />
When you find a 'REPLACE WITH'-Statement, the Code quoted in the 'FIND'-Statement have to be replaced completely with the quoted Code in the 'REPLACE WITH'-Statement.<br />
When you find a 'DELETE'-Statement, the Code have to be deleted.<br />
<br />
After you have finished this tutorial, you have to upload the update_to_210.php file, execute it and then delete it from your webspace.<br />
<br />
Ok, lets start:<br />
<br />
<br />
<span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>admin/admin_board.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 46</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$default_config&#91;$config_name&#93; = $config_value;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$default_config&#91;$config_name&#93; = isset&#40;$HTTP_POST_VARS&#91;'submit'&#93;&#41; ? str_replace&#40;&quot;'&quot;, &quot;\'&quot;, $config_value&#41; &#58; $config_value;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>admin/admin_styles.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 49</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
require&#40;'./pagestart.' . $phpEx&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
<br />
$confirm = &#40; isset&#40;$HTTP_POST_VARS&#91;'confirm'&#93;&#41; &#41; ? TRUE &#58; FALSE;<br />
$cancel = &#40; isset&#40;$HTTP_POST_VARS&#91;'cancel'&#93;&#41; &#41; ? TRUE &#58; FALSE;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>admin/index.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 335</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;AND u.user_session_time &gt;= &quot; . &#40; time&#40;&#41; - 300 &#41; . &quot; <br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;AND s.session_time &gt;= &quot; . &#40; time&#40;&#41; - 300 &#41; . &quot; <br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>common.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 27</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;die&#40;&quot;Hacking attempt&quot;&#41;;<br />
&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
//<br />
function unset_vars&#40;&$var&#41;<br />
&#123;<br />
&nbsp; &nbsp;while &#40;list&#40;$var_name, $null&#41; = @each&#40;$var&#41;&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;unset&#40;$GLOBALS&#91;$var_name&#93;&#41;;<br />
&nbsp; &nbsp;&#125;<br />
&nbsp; &nbsp;return;<br />
&#125;<br />
<br />
//<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 41</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
error_reporting&nbsp; &#40;E_ERROR | E_WARNING | E_PARSE&#41;; // This will NOT report uninitialized variables<br />
set_magic_quotes_runtime&#40;0&#41;; // Disable magic_quotes_runtime<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$ini_val = &#40;@phpversion&#40;&#41; &gt;= '4.0.0'&#41; ? 'ini_get' &#58; 'get_cfg_var';<br />
<br />
// Unset globally registered vars - PHP5 ... hhmmm<br />
if &#40;@$ini_val&#40;'register_globals'&#41; == '1' || strtolower&#40;@$ini_val&#40;'register_globals'&#41;&#41; == 'on'&#41;<br />
&#123;<br />
&nbsp; &nbsp;$var_prefix = 'HTTP';<br />
&nbsp; &nbsp;$var_suffix = '_VARS';<br />
&nbsp; &nbsp;<br />
&nbsp; &nbsp;$test = array&#40;'_GET', '_POST', '_SERVER', '_COOKIE', '_ENV'&#41;;<br />
<br />
&nbsp; &nbsp;foreach &#40;$test as $var&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;if &#40;is_array&#40;$&#123;$var_prefix . $var . $var_suffix&#125;&#41;&#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;unset_vars&#40;$&#123;$var_prefix . $var . $var_suffix&#125;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;@reset&#40;$&#123;$var_prefix . $var . $var_suffix&#125;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />
<br />
&nbsp; &nbsp;&nbsp; &nbsp;if &#40;is_array&#40;$&#123;$var&#125;&#41;&#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;unset_vars&#40;$&#123;$var&#125;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;@reset&#40;$&#123;$var&#125;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />
&nbsp; &nbsp;&#125;<br />
<br />
&nbsp; &nbsp;if &#40;is_array&#40;$&#123;'_FILES'&#125;&#41;&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;unset_vars&#40;$&#123;'_FILES'&#125;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;@reset&#40;$&#123;'_FILES'&#125;&#41;;<br />
&nbsp; &nbsp;&#125;<br />
<br />
&nbsp; &nbsp;if &#40;is_array&#40;$&#123;'HTTP_POST_FILES'&#125;&#41;&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;unset_vars&#40;$&#123;'HTTP_POST_FILES'&#125;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;@reset&#40;$&#123;'HTTP_POST_FILES'&#125;&#41;;<br />
&nbsp; &nbsp;&#125;<br />
&#125;<br />
<br />
// PHP5 with register_long_arrays off?<br />
if &#40;!isset&#40;$HTTP_POST_VARS&#41; && isset&#40;$_POST&#41;&#41;<br />
&#123;<br />
&nbsp; &nbsp;$HTTP_POST_VARS = $_POST;<br />
&nbsp; &nbsp;$HTTP_GET_VARS = $_GET;<br />
&nbsp; &nbsp;$HTTP_SERVER_VARS = $_SERVER;<br />
&nbsp; &nbsp;$HTTP_COOKIE_VARS = $_COOKIE;<br />
&nbsp; &nbsp;$HTTP_ENV_VARS = $_ENV;<br />
&nbsp; &nbsp;$HTTP_POST_FILES = $_FILES;<br />
&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 153</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$theme = array&#40;&#41;;<br />
$images = array&#40;&#41;;<br />
$lang = array&#40;&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$nav_links = array&#40;&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 174</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
if&#40; getenv&#40;'HTTP_X_FORWARDED_FOR'&#41; != '' &#41;<br />
&#123;<br />
&nbsp; &nbsp;$client_ip = &#40; !empty&#40;$HTTP_SERVER_VARS&#91;'REMOTE_ADDR'&#93;&#41; &#41; ? $HTTP_SERVER_VARS&#91;'REMOTE_ADDR'&#93; &#58; &#40; &#40; !empty&#40;$HTTP_ENV_VARS&#91;'REMOTE_ADDR'&#93;&#41; &#41; ? $HTTP_ENV_VARS&#91;'REMOTE_ADDR'&#93; &#58; $REMOTE_ADDR &#41;;<br />
<br />
&nbsp; &nbsp;$entries = explode&#40;',', getenv&#40;'HTTP_X_FORWARDED_FOR'&#41;&#41;;<br />
&nbsp; &nbsp;reset&#40;$entries&#41;;<br />
&nbsp; &nbsp;while &#40;list&#40;, $entry&#41; = each&#40;$entries&#41;&#41; <br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$entry = trim&#40;$entry&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;if &#40; preg_match&#40;&quot;/^&#40;&#91;0-9&#93;+\.&#91;0-9&#93;+\.&#91;0-9&#93;+\.&#91;0-9&#93;+&#41;/&quot;, $entry, $ip_list&#41; &#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$private_ip = array&#40;'/^0\./', '/^127\.0\.0\.1/', '/^192\.168\..*/', '/^172\.&#40;&#40;1&#91;6-9&#93;&#41;|&#40;2&#91;0-9&#93;&#41;|&#40;3&#91;0-1&#93;&#41;&#41;\..*/', '/^10\..*/', '/^224\..*/', '/^240\..*/'&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$found_ip = preg_replace&#40;$private_ip, $client_ip, $ip_list&#91;1&#93;&#41;;<br />
<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if &#40;$client_ip != $found_ip&#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$client_ip = $found_ip;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;break;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />
&nbsp; &nbsp;&#125;<br />
&#125;<br />
else<br />
&#123;<br />
&nbsp; &nbsp;$client_ip = &#40; !empty&#40;$HTTP_SERVER_VARS&#91;'REMOTE_ADDR'&#93;&#41; &#41; ? $HTTP_SERVER_VARS&#91;'REMOTE_ADDR'&#93; &#58; &#40; &#40; !empty&#40;$HTTP_ENV_VARS&#91;'REMOTE_ADDR'&#93;&#41; &#41; ? $HTTP_ENV_VARS&#91;'REMOTE_ADDR'&#93; &#58; $REMOTE_ADDR &#41;;<br />
&#125;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
// I'm removing HTTP_X_FORWARDED_FOR ... this may well cause other problems such as<br />
// private range IP's appearing instead of the guilty routable IP, tough, don't<br />
// even bother complaining ... go scream and shout at the idiots out there who feel<br />
// &quot;clever&quot; is doing harm rather than good ... karma is a great thing ... &#58;&#41;<br />
//<br />
$client_ip = &#40; !empty&#40;$HTTP_SERVER_VARS&#91;'REMOTE_ADDR'&#93;&#41; &#41; ? $HTTP_SERVER_VARS&#91;'REMOTE_ADDR'&#93; &#58; &#40; &#40; !empty&#40;$HTTP_ENV_VARS&#91;'REMOTE_ADDR'&#93;&#41; &#41; ? $HTTP_ENV_VARS&#91;'REMOTE_ADDR'&#93; &#58; $REMOTE_ADDR &#41;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>faq.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 37</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
// End session management<br />
//<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
// Set vars to prevent naughtiness<br />
$faq = array&#40;&#41;;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 103</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
make_jumpbox&#40;'viewforum.'.$phpEx, $forum_id&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
make_jumpbox&#40;'viewforum.'.$phpEx&#41;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>groupcp.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 428</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;AND aa.group_id = g.group_id&#40;+&#41;&quot;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;AND aa.group_id &#40;+&#41; = g.group_id&quot;;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 1152</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;// Select all group that the user is a member of or where the user has<br />
&nbsp; &nbsp;// a pending membership.<br />
&nbsp; &nbsp;//<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$in_group = array&#40;&#41;;<br />
&nbsp; &nbsp;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 1248</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$s_hidden_fields = '';<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$s_hidden_fields = '&lt;input type=&quot;hidden&quot; name=&quot;sid&quot; value=&quot;' . $userdata&#91;'session_id'&#93; . '&quot; /&gt;';<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>includes/bbcode.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 284</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$text = preg_replace&#40;&quot;#\&#91;img\&#93;&#40;&#40;ht|f&#41;tp&#58;//&#41;&#40;&#91;^ \?&=\&quot;\n\r\t&lt;&#93;*?&#40;\.&#40;jpg|jpeg|gif|png&#41;&#41;&#41;\&#91;/img\&#93;#sie&quot;, &quot;'&#91;img&#58;$uid&#93;\\1' . str_replace&#40;' ', '%20', '\\3'&#41; . '&#91;/img&#58;$uid&#93;'&quot;, $text&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$text = preg_replace&#40;&quot;#\&#91;img\&#93;&#40;&#40;http|ftp|https|ftps&#41;&#58;//&#41;&#40;&#91;^ \?&=\#\&quot;\n\r\t&lt;&#93;*?&#40;\.&#40;jpg|jpeg|gif|png&#41;&#41;&#41;\&#91;/img\&#93;#sie&quot;, &quot;'&#91;img&#58;$uid&#93;\\1' . str_replace&#40;' ', '%20', '\\3'&#41; . '&#91;/img&#58;$uid&#93;'&quot;, $text&#41;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>includes/functions.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 190</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;if &#40; !empty&#40;$SID&#41; &#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$boxstring .= '&lt;input type=&quot;hidden&quot; name=&quot;sid&quot; value=&quot;' . $userdata&#91;'session_id'&#93; . '&quot; /&gt;';<br />
&nbsp; &nbsp;&#125;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;// Let the jumpbox work again in sites having additional session id checks.<br />
//&nbsp; &nbsp;if &#40; !empty&#40;$SID&#41; &#41;<br />
//&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$boxstring .= '&lt;input type=&quot;hidden&quot; name=&quot;sid&quot; value=&quot;' . $userdata&#91;'session_id'&#93; . '&quot; /&gt;';<br />
//&nbsp; &nbsp;&#125;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 743</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;if &#40;!empty&#40;$db&#41;&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$db-&gt;sql_close&#40;&#41;;<br />
&nbsp; &nbsp;&#125;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;if &#40;strstr&#40;urldecode&#40;$url&#41;, &quot;\n&quot;&#41; || strstr&#40;urldecode&#40;$url&#41;, &quot;\r&quot;&#41;&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;message_die&#40;GENERAL_ERROR, 'Tried to redirect to potentially insecure url.'&#41;;<br />
&nbsp; &nbsp;&#125;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>includes/functions_post.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 772</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$page_title = $lang&#91;'Review_topic'&#93; . &quot; - $topic_title&quot;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$page_title = $lang&#91;'Emoticons'&#93; . &quot; - $topic_title&quot;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>includes/page_header.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 94</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$logged_hidden_online = 0;<br />
$guests_online = 0;<br />
$online_userlist = '';<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$l_online_users = '';<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 115</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$prev_user_ip = '';<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$prev_user_ip = $prev_session_ip = '';<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>includes/sessions.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 48</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$sessiondata = array&#40;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$session_id = &#40; isset&#40;$HTTP_GET_VARS&#91;'sid'&#93;&#41; &#41; ? $HTTP_GET_VARS&#91;'sid'&#93; &#58; '';<br />
&nbsp; &nbsp;&nbsp; &nbsp;$sessionmethod = SESSION_METHOD_GET;<br />
&nbsp; &nbsp;&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;//<br />
&nbsp; &nbsp;if &#40;!preg_match&#40;'/^&#91;A-Za-z0-9&#93;*$/', $session_id&#41;&#41; <br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$session_id = '';<br />
&nbsp; &nbsp;&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 224</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$sessiondata = array&#40;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$session_id = &#40; isset&#40;$HTTP_GET_VARS&#91;'sid'&#93;&#41; &#41; ? $HTTP_GET_VARS&#91;'sid'&#93; &#58; '';<br />
&nbsp; &nbsp;&nbsp; &nbsp;$sessionmethod = SESSION_METHOD_GET;<br />
&nbsp; &nbsp;&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;if &#40;!preg_match&#40;'/^&#91;A-Za-z0-9&#93;*$/', $session_id&#41;&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;$session_id = '';<br />
&nbsp; &nbsp;&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 360</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$sessionmethod = SESSION_METHOD_GET;<br />
&nbsp; &nbsp;&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;if &#40;!preg_match&#40;'/^&#91;A-Za-z0-9&#93;*$/', $session_id&#41;&#41;<br />
&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;return;<br />
&nbsp; &nbsp;&#125;<br />
&nbsp; &nbsp;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>includes/usercp_avatar.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 86</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;if &#40; !preg_match&#40;'#^&#40;&#40;http&#41;|&#40;ftp&#41;&#58;\/\/&#91;\w\-&#93;+?\.&#40;&#91;\w\-&#93;+\.&#41;+&#91;\w&#93;+&#40;&#58;&#91;0-9&#93;+&#41;*\/.*?\.&#40;gif|jpg|jpeg|png&#41;$&#41;#is', $avatar_filename&#41; &#41;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;if &#40; !preg_match&#40;&quot;#^&#40;&#40;ht|f&#41;tp&#58;//&#41;&#40;&#91;^ \?&=\#\&quot;\n\r\t&lt;&#93;*?&#40;\.&#40;jpg|jpeg|gif|png&#41;&#41;$&#41;#is&quot;, $avatar_filename&#41; &#41;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>includes/usercp_viewprofile.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 44</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;message_die&#40;GENERAL_ERROR, 'Could not obtain ranks information', '', __LINE__, __FILE__, $sql&#41;;<br />
&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$ranksrow = array&#40;&#41;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>index.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 121</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;message_die&#40;GENERAL_ERROR, 'Could not query categories list', '', __LINE__, __FILE__, $sql&#41;;<br />
&#125;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$category_rows = array&#40;&#41;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>login.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 96</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$redirect = &#40; !empty&#40;$HTTP_POST_VARS&#91;'redirect'&#93;&#41; &#41; ? str_replace&#40;'&amp;', '&', htmlspecialchars&#40;$HTTP_POST_VARS&#91;'redirect'&#93;&#41;&#41; &#58; '';<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$redirect = str_replace&#40;'?', '&', $redirect&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if &#40;strstr&#40;urldecode&#40;$redirect&#41;, &quot;\n&quot;&#41; || strstr&#40;urldecode&#40;$redirect&#41;, &quot;\r&quot;&#41;&#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;message_die&#40;GENERAL_ERROR, 'Tried to redirect to potentially insecure url.'&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 116</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$redirect = &#40; !empty&#40;$HTTP_POST_VARS&#91;'redirect'&#93;&#41; &#41; ? str_replace&#40;'&amp;', '&', htmlspecialchars&#40;$HTTP_POST_VARS&#91;'redirect'&#93;&#41;&#41; &#58; &quot;&quot;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$redirect = str_replace&#40;&quot;?&quot;, &quot;&&quot;, $redirect&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if &#40;strstr&#40;urldecode&#40;$redirect&#41;, &quot;\n&quot;&#41; || strstr&#40;urldecode&#40;$redirect&#41;, &quot;\r&quot;&#41;&#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;message_die&#40;GENERAL_ERROR, 'Tried to redirect to potentially insecure url.'&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>memberlist.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 238</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'ROW_NUMBER' =&gt; $i + &#40; $HTTP_GET_VARS&#91;'start'&#93; + 1 &#41;,<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'ROW_NUMBER' =&gt; $i + &#40; $start + 1 &#41;,<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>modcp.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 841</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;'S_FORUM_SELECT' =&gt; make_forum_select&#40;&quot;new_forum_id&quot;, false, $forum_id&#41;&#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#41;;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;//<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// Define censored word matches<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;//<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$orig_word = array&#40;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$replacement_word = array&#40;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;obtain_word_list&#40;$orig_word, $replacement_word&#41;;<br />
<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 847</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$poster_id = $postrow&#91;$i&#93;&#91;'user_id'&#93;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$poster_id = $postrow&#91;$i&#93;&#91;'poster_id'&#93;;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">DELETE - Line 879</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;//<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;// Define censored word matches<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;//<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$orig_word = array&#40;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$replacement_word = array&#40;&#41;;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;obtain_word_list&#40;$orig_word, $replacement_word&#41;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>posting.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 33</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$params = array&#40;'submit' =&gt; 'post', 'confirm' =&gt; 'confirm', 'preview' =&gt; 'preview', 'delete' =&gt; 'delete', 'poll_delete' =&gt; 'poll_delete', 'poll_add' =&gt; 'add_poll_option', 'poll_edit' =&gt; 'edit_poll_option', 'mode' =&gt; 'mode'&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$params = array&#40;'submit' =&gt; 'post', 'preview' =&gt; 'preview', 'delete' =&gt; 'delete', 'poll_delete' =&gt; 'poll_delete', 'poll_add' =&gt; 'add_poll_option', 'poll_edit' =&gt; 'edit_poll_option', 'mode' =&gt; 'mode'&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 45</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;$$var = '';<br />
&nbsp; &nbsp;&#125;<br />
&#125;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
<br />
$confirm = isset&#40;$HTTP_POST_VARS&#91;'confirm'&#93;&#41; ? true &#58; false;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>privmsg.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 215</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$pm_sql_user .= &quot;AND &#40; &#40; pm.privmsgs_to_userid = &quot; . $userdata&#91;'user_id'&#93; . &quot;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$pm_sql_user = &quot;AND &#40; &#40; pm.privmsgs_to_userid = &quot; . $userdata&#91;'user_id'&#93; . &quot;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 496</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$temp_url = append_sid&#40;&quot;privmsg.$phpEx?mode=post&amp;&quot; . POST_USERS_URL . &quot;=$poster_id&quot;&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$temp_url = append_sid&#40;&quot;privmsg.$phpEx?mode=post&amp;&quot; . POST_USERS_URL . &quot;=$user_id_from&quot;&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 1045</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;OR privmsgs_type = &quot; . PRIVMSGS_UNERAD_MAIL . &quot; &#41; &quot;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;OR privmsgs_type = &quot; . PRIVMSGS_UNREAD_MAIL . &quot; &#41; &quot;;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 1855</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$post_new_mesg_url = '&lt;a href=&quot;' . append_sid&#40;&quot;privmsg.$phpEx?mode=post&quot;&#41; . '&quot;&gt;&lt;img src=&quot;' . $images&#91;'post_new'&#93; . '&quot; alt=&quot;' . $lang&#91;'Post_new_message'&#93; . '&quot; border=&quot;0&quot; /&gt;&lt;/a&gt;';<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
$post_new_mesg_url = '&lt;a href=&quot;' . append_sid&#40;&quot;privmsg.$phpEx?mode=post&quot;&#41; . '&quot;&gt;&lt;img src=&quot;' . $images&#91;'post_new'&#93; . '&quot; alt=&quot;' . $lang&#91;'Send_a_new_message'&#93; . '&quot; border=&quot;0&quot; /&gt;&lt;/a&gt;';<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 1935</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$limit_msg_time = '';<br />
&nbsp; &nbsp;$post_days = 0;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$limit_msg_time = $limit_msg_time_total = '';<br />
&nbsp; &nbsp;$msg_days = 0;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 2066</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;'U_POST_NEW_TOPIC' =&gt; $post_new_topic_url&#41;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;'U_POST_NEW_TOPIC' =&gt; append_sid&#40;&quot;privmsg.$phpEx?mode=post&quot;&#41;&#41;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>profile.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 86</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
if &#40; isset&#40;$HTTP_GET_VARS&#91;'mode'&#93;&#41; || isset&#40;$HTTP_POST_VARS&#91;'mode'&#93;&#41; &#41;<br />
&#123;<br />
&nbsp; &nbsp;$mode = &#40; isset&#40;$HTTP_GET_VARS&#91;'mode'&#93;&#41; &#41; ? $HTTP_GET_VARS&#91;'mode'&#93; &#58; $HTTP_POST_VARS&#91;'mode'&#93;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$mode = htmlspecialchars&#40;$mode&#41;;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>search.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 62</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$search_author = &#40; isset&#40;$HTTP_POST_VARS&#91;'search_author'&#93;&#41; &#41; ? $HTTP_POST_VARS&#91;'search_author'&#93; &#58; $HTTP_GET_VARS&#91;'search_author'&#93;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$search_author = htmlspecialchars&#40;$search_author&#41;;<br />

<br /></td>  	</tr></table><br /><span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 113</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$search_time = time&#40;&#41; - &#40; &#40; &#40; !empty&#40;$HTTP_POST_VARS&#91;'search_time'&#93;&#41; &#41; ? intval&#40;$HTTP_POST_VARS&#91;'search_time'&#93;&#41; &#58; intval&#40;$HTTP_GET_VARS&#91;'search_time'&#93;&#41; &#41; * 86400 &#41;;<br />
&#125;<br />
else<br />
&#123;<br />
&nbsp; &nbsp;$search_time = 0;<br />
&#125;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;$search_time = time&#40;&#41; - &#40; &#40; &#40; !empty&#40;$HTTP_POST_VARS&#91;'search_time'&#93;&#41; &#41; ? intval&#40;$HTTP_POST_VARS&#91;'search_time'&#93;&#41; &#58; intval&#40;$HTTP_GET_VARS&#91;'search_time'&#93;&#41; &#41; * 86400 &#41;;<br />
&nbsp; &nbsp;$topic_days = &#40;!empty&#40;$HTTP_POST_VARS&#91;'search_time'&#93;&#41;&#41; ? intval&#40;$HTTP_POST_VARS&#91;'search_time'&#93;&#41; &#58; intval&#40;$HTTP_GET_VARS&#91;'search_time'&#93;&#41;;<br />
&#125;<br />
else<br />
&#123;<br />
&nbsp; &nbsp;$search_time = 0;<br />
&nbsp; &nbsp;$topic_days = 0;<br />
&#125;<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>viewonline.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 49</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;'L_WHOSONLINE' =&gt; $lang&#91;'Who_is_online'&#93;,<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">REPLACE WITH</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;'L_WHOSONLINE' =&gt; $lang&#91;'Who_is_Online'&#93;,<br />

<br /></td>  	</tr></table><br /><br /></ol><span style="font-size: 18px; line-height: normal"><span style="color: blue"><ul><li>viewtopic.php</span></span></ul><br /><br /><ol type="1">
<span class="postbody">
<br /><li>
<span class="postbody"><br /><span style="color: blue">FIND - Line 66</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.8 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
&nbsp; &nbsp;&nbsp; &nbsp;if &#40; isset&#40;$HTTP_COOKIE_VARS&#91;$board_config&#91;'cookie_name'&#93; . '_sid'&#93;&#41; || isset&#40;$HTTP_GET_VARS&#91;'sid'&#93;&#41; &#41;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$session_id = isset&#40;$HTTP_COOKIE_VARS&#91;$board_config&#91;'cookie_name'&#93; . '_sid'&#93;&#41; ? $HTTP_COOKIE_VARS&#91;$board_config&#91;'cookie_name'&#93; . '_sid'&#93; &#58; $HTTP_GET_VARS&#91;'sid'&#93;;<br />

<br /></td>  	</tr></table><br /><span class="postbody"><br /><span style="color: blue">AFTER, ADD</span>
<br /></span><table width="90%" cellspacing="1" cellpadding="3" border="0" align="center"><tr> 
     <td><span class="genmed"><b>2.0.10 Code:</b></span></td>
</tr>
<tr>
     <td class="code">
<br /><br />
<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if &#40;!preg_match&#40;'/^&#91;A-Za-z0-9&#93;*$/', $session_id&#41;&#41; <br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#123;<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$session_id = '';<br />
&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&#125;<br />
<br />

<br /></td>  	</tr></table><br /><br /></ol>					</td>
			</tr>
		</table></td>
	</tr>
</table></html>
